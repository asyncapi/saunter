{
  "asyncapi": "2.6.0",
  "info": {
    "title": "Streetlights API",
    "version": "1.0.0",
    "description": "The Smartylighting Streetlights API allows you to remotely manage the city lights.",
    "license": {
      "name": "Apache 2.0",
      "url": "https://www.apache.org/licenses/LICENSE-2.0"
    }
  },
  "servers": {
    "mosquitto": {
      "url": "test.mosquitto.org",
      "protocol": "mqtt"
    },
    "webapi": {
      "url": "localhost:5000",
      "protocol": "http"
    }
  },
  "defaultContentType": "application/json",
  "channels": {
    "publish/light/measured": {
      "servers": [
        "webapi"
      ],
      "publish": {
        "operationId": "MeasureLight",
        "summary": "Inform about environmental lighting conditions for a particular streetlight.",
        "tags": [
          {
            "name": "Light"
          }
        ],
        "message": {
          "$ref": "#/components/messages/lightMeasuredEvent"
        }
      }
    },
    "subscribe/light/measured": {
      "servers": [
        "mosquitto"
      ],
      "subscribe": {
        "operationId": "PublishLightMeasurement",
        "summary": "Subscribe to environmental lighting conditions for a particular streetlight.",
        "tags": [
          {
            "name": "Light"
          }
        ],
        "message": {
          "payload": {
            "$ref": "#/components/schemas/lightMeasuredEvent"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "lightMeasuredEvent": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int32",
            "description": "Id of the streetlight."
          },
          "lumens": {
            "type": "integer",
            "format": "int32",
            "description": "Light intensity measured in lumens."
          },
          "sentAt": {
            "type": "string",
            "format": "date-time",
            "description": "Light intensity measured in lumens."
          }
        },
        "additionalProperties": false
      }
    },
    "messages": {
      "lightMeasuredEvent": {
        "payload": {
          "$ref": "#/components/schemas/lightMeasuredEvent"
        },
        "name": "lightMeasuredEvent"
      }
    }
  }
}